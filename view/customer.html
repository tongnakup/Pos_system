<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
    <style>
      body {
        font-family: "Sarabun", sans-serif;
        margin: 0;
        display: flex;
        height: 100vh;
        background-color: #f0f2f5;
        color: #333;
        overflow: hidden;
      }

      /* --- ‡∏ù‡∏±‡πà‡∏á‡∏ã‡πâ‡∏≤‡∏¢: ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ --- */
      .left-panel {
        flex: 6;
        background: white;
        display: flex;
        flex-direction: column;
        border-right: 1px solid #ddd;
        padding: 25px;
        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.05);
        z-index: 2;
      }
      .header {
        font-size: 1.8em;
        font-weight: bold;
        color: #2c3e50;
        padding-bottom: 20px;
        border-bottom: 3px solid #3498db;
        margin-bottom: 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      /* ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ */
      .item-list {
        flex: 1;
        overflow-y: auto;
        padding-right: 10px;
      }
      /* Scrollbar ‡∏™‡∏ß‡∏¢‡πÜ */
      .item-list::-webkit-scrollbar {
        width: 6px;
      }
      .item-list::-webkit-scrollbar-thumb {
        background: #ccc;
        border-radius: 3px;
      }

      .item-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px;
        margin-bottom: 10px;
        background: #f8f9fa;
        border-radius: 10px;
        font-size: 1.3em;
        animation: fadeInLeft 0.3s;
        transition: 0.2s;
      }
      .item-row:last-child {
        border-left: 5px solid #3498db;
        background: #eef7fc;
      }
      .item-name {
        font-weight: bold;
        color: #2c3e50;
      }
      .item-detail {
        color: #7f8c8d;
        font-size: 0.8em;
        margin-top: 5px;
      }
      .item-price {
        font-weight: bold;
        color: #2c3e50;
        font-size: 1.1em;
      }

      /* --- ‡∏ù‡∏±‡πà‡∏á‡∏Ç‡∏ß‡∏≤: ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° & QR --- */
      .right-panel {
        flex: 4;
        background: #2c3e50;
        color: white;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        padding: 30px;
        position: relative;
        overflow: hidden;
      }
      /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á Pattern ‡∏™‡∏ß‡∏¢‡πÜ */
      .right-panel::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: radial-gradient(#ffffff 1px, transparent 1px);
        background-size: 20px 20px;
        opacity: 0.05;
        pointer-events: none;
      }

      /* ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥ */
      #normal-total-view {
        width: 100%;
        z-index: 1;
      }
      .total-label {
        font-size: 1.8em;
        color: #bdc3c7;
        margin-bottom: 10px;
        letter-spacing: 1px;
      }
      .total-amount {
        font-size: 6em;
        font-weight: 800;
        color: #2ecc71;
        text-shadow: 0 4px 10px rgba(46, 204, 113, 0.3);
        line-height: 1;
        margin-bottom: 20px;
      }
      .unit {
        font-size: 0.4em;
        color: #95a5a6;
        vertical-align: top;
      }

      .change-box {
        margin-top: 30px;
        background: rgba(255, 255, 255, 0.1);
        padding: 25px;
        border-radius: 15px;
        border: 1px solid rgba(255, 255, 255, 0.2);
        display: none;
        animation: fadeInUp 0.3s;
      }
      .change-label {
        font-size: 1.4em;
        color: #f1c40f;
        margin-bottom: 5px;
      }
      .change-amount {
        font-size: 3.5em;
        font-weight: bold;
        color: white;
      }

      /* ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á QR Code */
      #customer-qr-box {
        display: none;
        text-align: center;
        animation: zoomIn 0.3s;
        z-index: 1;
        background: white;
        padding: 30px;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      }
      #customer-qr-box h3 {
        color: #2c3e50;
        margin: 0 0 15px 0;
        font-size: 1.5em;
      }

      /* --- Idle Screen (‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏û‡∏±‡∏Å) --- */
      #idle-screen {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #3498db, #8e44ad);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 100;
        color: white;
        text-align: center;
      }
      .idle-content {
        animation: pulse 3s infinite;
      }
      .shop-logo {
        font-size: 8em;
        margin-bottom: 20px;
        text-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }
      .shop-welcome {
        font-size: 3.5em;
        font-weight: bold;
        margin: 0;
      }
      .shop-sub {
        font-size: 1.5em;
        opacity: 0.8;
        margin-top: 10px;
      }

      #success-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(39, 174, 96, 0.95);
        display: none;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 50;
        color: white;
        text-align: center;
      }
      .success-icon {
        font-size: 8em;
        margin-bottom: 10px;
        animation: bounceIn 0.5s;
      }
      .success-text {
        font-size: 3em;
        font-weight: bold;
        animation: fadeInUp 0.5s 0.2s both;
      }
      .success-sub {
        font-size: 1.5em;
        opacity: 0.9;
        animation: fadeInUp 0.5s 0.4s both;
      }

      /* --- ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å (Member Badge) --- */
      #customer-member-badge {
        display: none;
        background: rgba(255, 255, 255, 0.15);
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 12px;
        padding: 15px;
        width: 80%;
        margin-bottom: 20px;
        text-align: left;
        animation: fadeInDown 0.5s;
      }
      .mem-label {
        color: #f39c12;
        font-weight: bold;
        font-size: 0.9em;
        text-transform: uppercase;
        letter-spacing: 1px;
      }
      .mem-name {
        font-size: 1.4em;
        font-weight: bold;
        color: white;
        margin: 5px 0;
      }
      .mem-points {
        font-size: 1em;
        color: #bdc3c7;
      }
      .mem-points span {
        color: #f1c40f;
        font-weight: bold;
        font-size: 1.2em;
      }

      .btn-customer-member {
        background: #e67e22;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 30px;
        font-size: 1.2em;
        font-weight: bold;
        cursor: pointer;
        box-shadow: 0 4px 10px rgba(230, 126, 34, 0.4);
        margin-bottom: 20px;
        width: 100%;
        transition: transform 0.1s;
        position: relative;
        z-index: 10;
      }
      .btn-customer-member:active {
        transform: scale(0.95);
      }

      /* Modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏î‡πÄ‡∏ö‡∏≠‡∏£‡πå (Keypad) */
      #customer-login-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        z-index: 200;
        justify-content: center;
        align-items: center;
      }
      .keypad-box {
        background: white;
        padding: 30px;
        border-radius: 20px;
        width: 320px;
        text-align: center;
      }
      .keypad-display {
        font-size: 2em;
        padding: 15px;
        width: 100%;
        box-sizing: border-box;
        margin-bottom: 20px;
        border: 2px solid #3498db;
        border-radius: 10px;
        text-align: center;
        letter-spacing: 2px;
      }
      .keypad-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
      }
      .key-btn {
        background: #ecf0f1;
        border: none;
        padding: 20px;
        font-size: 1.5em;
        border-radius: 10px;
        cursor: pointer;
        color: #2c3e50;
        font-weight: bold;
      }
      .key-btn:active {
        background: #bdc3c7;
      }
      .key-submit {
        background: #2ecc71;
        color: white;
        grid-column: span 3;
      }
      .key-clear {
        background: #e74c3c;
        color: white;
      }
      /* ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÉ‡∏´‡πâ‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏° */
      .key-close {
        margin-top: 15px;
        background: #e74c3c;
        color: white;
        border: none;
        padding: 12px;
        border-radius: 10px;
        cursor: pointer;
        width: 100%;
        font-size: 1.1em;
        font-weight: bold;
        text-decoration: none;
        transition: background 0.2s, transform 0.1s;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .key-close:hover {
        background: #c0392b;
      }

      .key-close:active {
        transform: scale(0.95);
      }
    </style>
  </head>
  <body>
    <div id="idle-screen">
      <div class="idle-content">
        <div class="shop-logo">üè™</div>
        <h1 class="shop-welcome">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö</h1>
        <p class="shop-sub">‡πÄ‡∏ä‡∏¥‡∏ç‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö</p>
      </div>
    </div>

    <div id="success-overlay">
      <div class="success-icon">‚úÖ</div>
      <div class="success-text">‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏≠‡∏∏‡∏î‡∏´‡∏ô‡∏∏‡∏ô</div>

      <div id="success-change-display" style="margin-top: 20px; display: none">
        <div style="font-size: 1.2em; opacity: 0.8">‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</div>
        <div
          style="
            font-size: 4em;
            font-weight: bold;
            color: #f1c40f;
            text-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
          "
        >
          <span id="succ-change-amt">0.00</span> ‡∏ø
        </div>
      </div>

      <div class="success-sub" style="margin-top: 30px">
        ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ä‡∏¥‡∏ç‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö
      </div>
    </div>

    <div class="left-panel">
      <div class="header">
        <span>üõí ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</span>
        <span
          id="item-count"
          style="
            background: #3498db;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.6em;
          "
          >0 ‡∏ä‡∏¥‡πâ‡∏ô</span
        >
      </div>
      <div class="item-list" id="customer-list"></div>
    </div>

    <div class="right-panel">
      <button
        onclick="openCustomerKeypad()"
        class="btn-customer-member"
        id="btn-mem-login"
      >
        ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å (‡∏Å‡∏î‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà)
      </button>

      <div id="customer-member-badge">
        <div class="mem-label">‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å / Member</div>
        <div class="mem-name" id="disp-mem-name">-</div>
        <div class="mem-points">
          ‡πÅ‡∏ï‡πâ‡∏°‡∏™‡∏∞‡∏™‡∏°: <span id="disp-mem-points">0</span>
        </div>
      </div>

      <div id="customer-qr-box">
        <h3>‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h3>
        <img
          id="cust-qr-image"
          src=""
          style="width: 250px; height: 250px; border-radius: 10px"
        />
        <div
          style="
            font-size: 1.5em;
            color: #2c3e50;
            font-weight: bold;
            margin-top: 10px;
          "
        >
          ‡∏¢‡∏≠‡∏î <span id="cust-qr-amount" style="color: #2ecc71">0.00</span> ‡∏ö‡∏≤‡∏ó
        </div>
      </div>

      <div id="normal-total-view">
        <div class="total-label">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</div>
        <div class="total-amount" id="customer-total">
          0.00 <span class="unit">‡∏ø</span>
        </div>

        <div class="change-box" id="customer-change-box">
          <div class="change-label">‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏≠‡∏ô</div>
          <div class="change-amount" id="customer-change">0.00</div>
        </div>
      </div>
    </div>

    <div id="customer-login-modal">
      <div class="keypad-box animate__animated animate__zoomIn">
        <h3 style="margin-top: 0; color: #333">‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</h3>
        <input
          type="text"
          id="cust-key-input"
          class="keypad-display"
          readonly
          placeholder="08x-xxx-xxxx"
        />

        <div class="keypad-grid">
          <button class="key-btn" onclick="typeKey('1')">1</button>
          <button class="key-btn" onclick="typeKey('2')">2</button>
          <button class="key-btn" onclick="typeKey('3')">3</button>
          <button class="key-btn" onclick="typeKey('4')">4</button>
          <button class="key-btn" onclick="typeKey('5')">5</button>
          <button class="key-btn" onclick="typeKey('6')">6</button>
          <button class="key-btn" onclick="typeKey('7')">7</button>
          <button class="key-btn" onclick="typeKey('8')">8</button>
          <button class="key-btn" onclick="typeKey('9')">9</button>
          <button class="key-btn key-clear" onclick="clearKey()">C</button>
          <button class="key-btn" onclick="typeKey('0')">0</button>
          <button class="key-btn key-submit" onclick="submitMemberPhone()">
            ‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
          </button>
        </div>
        <button class="key-close" onclick="closeCustomerKeypad()">
          ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å / ‡∏õ‡∏¥‡∏î
        </button>
      </div>
    </div>

    <script>
      window.addEventListener("storage", (e) => {
        if (e.key === "pos_cart_data") {
          const data = JSON.parse(e.newValue);
          renderCustomerScreen(data);
        }
      });

      // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ß‡∏≤‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
      function renderCustomerScreen(data) {
        const member = data.member || null;
        const cart = data.cart || [];
        const total = data.total || 0;
        const received = data.received || 0;
        const change = data.change || 0;
        const isFinished = data.finished || false;
        const qrCodeUrl = data.qrCode || null;

        // ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á Element ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
        const idleScreen = document.getElementById("idle-screen");
        const successOverlay = document.getElementById("success-overlay");
        const listEl = document.getElementById("customer-list");

        const qrBox = document.getElementById("customer-qr-box");
        const normalView = document.getElementById("normal-total-view");
        const qrImg = document.getElementById("cust-qr-image");
        const qrAmt = document.getElementById("cust-qr-amount");
        const changeBox = document.getElementById("customer-change-box");
        const changeEl = document.getElementById("customer-change");

        // ---‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á Element ‡∏Ç‡∏≠‡∏á‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å ---
        const memBadge = document.getElementById("customer-member-badge");
        const memName = document.getElementById("disp-mem-name");
        const memPoints = document.getElementById("disp-mem-points");
        const btnLogin = document.getElementById("btn-mem-login");

        if (isFinished) {
          successOverlay.style.display = "flex";

          const changeDiv = document.getElementById("success-change-display");
          const changeText = document.getElementById("succ-change-amt");

          if (change > 0) {
            changeDiv.style.display = "block";
            changeDiv.classList.add("animate__animated", "animate__bounceIn");
            changeText.innerText = change.toLocaleString("th-TH", {
              minimumFractionDigits: 2,
            });
          } else {
            changeDiv.style.display = "none";
          }

          return;
        } else {
          successOverlay.style.display = "none";
        }

        if (cart.length === 0) {
          idleScreen.style.display = "flex";
          if (memBadge) memBadge.style.display = "none";
          if (btnLogin) btnLogin.style.display = "block";
          return;
        } else {
          idleScreen.style.display = "none";
        }

        // --- Logic ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å ---
        if (member) {
          if (memBadge) {
            memBadge.style.display = "block";
            memName.innerText = member.name;
            memPoints.innerText = member.points.toLocaleString();
          }
          // ‡∏ã‡πà‡∏≠‡∏ô‡∏õ‡∏∏‡πà‡∏° Login ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß
          if (btnLogin) btnLogin.style.display = "none";
        } else {
          if (memBadge) memBadge.style.display = "none";
          // ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏° Login ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
          if (btnLogin) btnLogin.style.display = "block";
        }

        // ‡∏ß‡∏≤‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
        listEl.innerHTML = "";
        cart.forEach((item) => {
          const row = document.createElement("div");
          row.className = "item-row animate__animated animate__fadeInLeft";
          row.innerHTML = `
            <div>
                <div class="item-name">${item.name}</div>
                <div class="item-detail">${item.qty} x ${item.price.toFixed(
            2
          )}</div>
            </div>
            <div class="item-price">${(item.price * item.qty).toFixed(2)}</div>
          `;
          listEl.appendChild(row);
        });

        // ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏•‡∏á‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
        listEl.scrollTop = listEl.scrollHeight;
        document.getElementById("item-count").innerText =
          cart.reduce((sum, i) => sum + i.qty, 0) + " ‡∏ä‡∏¥‡πâ‡∏ô";

        if (qrCodeUrl) {
          normalView.style.display = "none";
          qrBox.style.display = "block";
          qrImg.src = qrCodeUrl;
          qrAmt.innerText = total.toLocaleString("th-TH", {
            minimumFractionDigits: 2,
          });
        } else {
          normalView.style.display = "block";
          qrBox.style.display = "none";

          document.getElementById("customer-total").innerHTML =
            total.toLocaleString("th-TH", { minimumFractionDigits: 2 }) +
            ' <span class="unit">‡∏ø</span>';

          if (received > 0) {
            changeBox.style.display = "block";
            changeEl.innerText = change.toLocaleString("th-TH", {
              minimumFractionDigits: 2,
            });
          } else {
            changeBox.style.display = "none";
          }
        }
      }

      function openCustomerKeypad() {
        console.log("üöÄ ‡πÄ‡∏õ‡∏¥‡∏î Modal ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏î..."); // ‡πÄ‡∏ä‡πá‡∏Ñ‡πÉ‡∏ô Console ‡∏ß‡πà‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏´‡∏°
        const modal = document.getElementById("customer-login-modal");
        const input = document.getElementById("cust-key-input");

        if (modal) {
          modal.style.display = "flex";
          modal.style.zIndex = "9999";
          if (input) input.value = "";
        } else {
          console.error(
            "‚ùå ‡∏´‡∏≤ ID 'customer-login-modal' ‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠! ‡πÄ‡∏ä‡πá‡∏Ñ HTML ‡∏≠‡∏µ‡∏Å‡∏ó‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö"
          );
          alert("Error: ‡∏´‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏î‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠");
        }
      }

      function closeCustomerKeypad() {
        const modal = document.getElementById("customer-login-modal");
        if (modal) modal.style.display = "none";
      }

      document.addEventListener("DOMContentLoaded", () => {
        const btn = document.getElementById("btn-mem-login");
        if (btn) {
          console.log("‚úÖ ‡∏û‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å ‡∏ú‡∏π‡∏Å events ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
          // ‡∏•‡∏ö event ‡πÄ‡∏Å‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏™‡πà‡πÉ‡∏´‡∏°‡πà
          btn.onclick = function (e) {
            e.preventDefault(); // ‡∏Å‡∏±‡∏ô‡∏°‡∏±‡∏ô‡πÄ‡∏î‡πâ‡∏á
            openCustomerKeypad();
          };
        } else {
          console.warn("‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏õ‡∏∏‡πà‡∏° id='btn-mem-login' ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ");
        }
      });

      function typeKey(num) {
        const input = document.getElementById("cust-key-input");
        if (input.value.length < 10) input.value += num;
      }

      function clearKey() {
        document.getElementById("cust-key-input").value = "";
      }

      function submitMemberPhone() {
        const phone = document.getElementById("cust-key-input").value;
        if (phone.length < 9) return;

        // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏´‡∏≤‡∏´‡∏ô‡πâ‡∏≤ Cashier
        localStorage.setItem(
          "pos_client_action",
          JSON.stringify({
            type: "MEMBER_LOGIN",
            phone: phone,
            timestamp: new Date().getTime(),
          })
        );

        closeCustomerKeypad();
      }

      // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
      const currentData = localStorage.getItem("pos_cart_data");
      if (currentData) renderCustomerScreen(JSON.parse(currentData));
    </script>
  </body>
</html>
